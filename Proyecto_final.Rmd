---
title: "Proyecto_Final"
author: "Sofia De León, Ignacio Campón, Jonathan Pirez, María de Freitas"
date: "28/6/2021"
output: pdf_document
urlcolor : blue
lang : es
---

## Introducción

El problema de estudio en el que nos vamos a centrar, se basa en el Reporte de Felicidad Mundial. 
Nos motiva y nos despierta interés analizar este mismo, debido a que sabemos lo importante que es la felicidad, el bienestar y la calidad de vida para cada una de las personas, y para que esto suceda debe ser una preocupación primordial para los gobiernos. Debido a esto, nos interesa analizar cuál es la relación de las distintas variables frente a la felicidad de la sociedad y también investigar si los niveles de felicidad han aumentado o disminuido a lo largo del tiempo. 

"El secreto de la felicidad no se encuentra en la búsqueda de más, sino en el desarrollo de la capacidad para disfrutar de menos". - Sócrates.


## Datos

Los datos que vamos a utilizar en este proyecto son de [Datos sobre felicidad](https://github.com/cienciadedatos/datos-de-miercoles/tree/master/datos/2019/2019-08-07) y su fuente es de [World Happines Report 2019](https://worldhappiness.report/ed/2019/)

Este conjunto de datos seleccionado tiene 17 variables y 1704 observaciones. 

```{r, echo = FALSE, include = FALSE}

library(dplyr)
library(xtable)

Variables <- c("pais", "año", "escalera_vida", "log_pib", "soporte_social", "expectativa_vida", "libertad", "generosidad", "Percepcion_corrupcion", "afecto_positivo", "afecto_negativo", "confianza", "calidad_democracia", "calidad_entrega", "de_escalera_pais_anio", "gini_banco_mundial", "gini_banco_mundial_promedio")

Descripción <- c("Paises", "Año desde 2005 hasta 2018", "Puntaje de felicidad", "Log Producto Interno Bruto", "Calidad del soporte social", "Expectativa de vida saludable", "Libertad para tomar decisiones de vida", "PBI per capita y la pregunta sobre si realiza donaciones", "Percepción de la corrupción", "Respuesta a preguntas sobre felicidad, risa y gozo", "Respuesta a preguntas sobre preocupación, tristeza y enojo", "Confianza en el gobierno", "Calidad de la democracia", "Calidad de la entrega de servicios por parte del gobierno", "Desviación estándar por país y año del puntaje de felicidad", "Gini según el Banco Munial", "Promedio Gini para el período 2000-2016")

tipo_variable <- c("Character", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric","Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric", "Numeric")

tabla <- data.frame(Variables, Descripción, tipo_variable)

x <- tabla %>%
     group_by(Variables) %>%
     summarise(Descripción, Tipo_Variable = tipo_variable)

```

```{r, echo = FALSE, message = FALSE, results = 'asis'}
xtable(x) 
```


# Análisis exploratorio 


```{r, echo = FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(forcats)
```


## Leemos los datos

```{r, echo = FALSE, include = FALSE}
felicidad <- readr::read_csv("https://raw.githubusercontent.com/cienciadedatos/datos-de-miercoles/master/datos/2019/2019-08-07/felicidad.csv")
```


### *Puntaje de felicidad para algunos paises de Sudamérica (Argentina, Bolivia, Brasil, Chile, Colombia, Ecuador, Paraguay, Perú, Uruguay, Venezuela) a lo largo de los años en grafico de puntos y lineas:*

```{r, echo = FALSE, message = FALSE, fig.cap = "Puntaje de felicidad a lo largo de los años para algunos países de Sudamérica. En estas figuras podemos observar que a lo largo de los años, estos países han tendio puntajes de felicidad que han ido creciendo y decreciendo; no ha sido siepre creciente. Podemos ver el caso de Venezuela que a partir del año 2012 hasta el 2016 pasó de tener un puntaje aproximadamente de 7 a 4 en cuatro años, un gran decrecimiento en el puntaje de felicidad, sin embargo luego de 2016 se puede observar que hubo un crecimiento en el mismo. Podemos ver el caso de Colombia que su puntaje de felicidad siempre estuvo entre 5.5 y 7."}
felicidad %>%
     group_by(pais) %>% 
     summarise(escalera_vida, anio) %>% 
     filter(pais %in% c("Uruguay", "Argentina", "Chile", "Brasil", "Ecuador", "Bolivia", "Paraguay", "Perú", "Colombia", "Venezuela")) %>% 
     ggplot(aes(x = anio, y = escalera_vida)) + geom_point() + geom_line() + facet_wrap(vars(pais)) + labs(x = "Año", y = "Puntaje de Felicidad")
```


### *Puntaje promedio de felicidad para algunos paises de Sudamérica en gráfico de barras:*

```{r, echo = TRUE, fig.cap = "Puntaje promedio de felicidad para algunos países de Sudamérica. En esta figura podemos observar que el país que tiene mayor puntaje promedio de felicidad es Brasil, mientras que el que tiene menor puntaje de felicidad corresponde a Paraguay."}
felicidad %>%
      group_by(pais) %>% 
       summarise(media_escalera_vida = mean(escalera_vida)) %>% 
     filter(pais %in% c("Uruguay", "Argentina", "Chile", "Brasil", "Ecuador", "Bolivia", "Paraguay", "Perú", "Colombia", "Venezuela")) %>% 
     ggplot(aes(x = reorder(pais, -media_escalera_vida), y = media_escalera_vida)) + geom_bar(stat = "identity") + labs(x = "País", y = "Puntaje promedio de felicidad")
```


### ¿Cuáles son los 6 paises que tiene el promedio de afecto negativo (preocupación, tristeza, enojo) más alto?


```{r, echo = TRUE}
mean_negativo <- felicidad %>%
      group_by(pais) %>% 
      summarise(mean_afecto_negativo = mean(afecto_negativo, na.rm = TRUE)) %>% 
      arrange(desc(mean_afecto_negativo))
```

```{r, echo = TRUE, message = FALSE, results = 'asis'}
xtable(head(mean_negativo), caption = "Top 6 de países con mayor promedio de afecto negativo")
```


En este caso podemos observar que el país que tiene el promedio más alto de afecto negativo es Irak. 

### *¿Existe alguna relación entre Felicidad-Pais?*

```{r, echo = TRUE}
fel_pais <- felicidad %>% 
  select(pais, anio, escalera_vida, log_pib, expectativa_vida) %>% 
  filter(pais %in% c("Uruguay", "Argentina", "Chile", "Brasil", "Ecuador", "Bolivia", "Paraguay", "Perú", "Colombia", "Venezuela"))

```

```{r, echo = TRUE, fig.cap = "Puntaje promedio de felicidad para algunos paises de Sudamérica en gráfico de caja. En esta figura al igual que en el grafico de barras podemos observar que el país que tiene mayor puntaje promedio de felicidad es Brasil y el que tiene menor puntaje en promedio es Paraguay; pero lo que no podemos visualizar en el grafico de barras es que Venezuela en algunos años fue el pais con menor y a su vez con mayor felicidad de Sudamerica."}
ggplot(fel_pais) + geom_boxplot(aes(x = reorder(pais,escalera_vida), y = escalera_vida)) + 
  labs(x = "Paises", y = "Grado de Felicidad")

```


### *¿Existe alguna relación entre Felicidad-PBI?*

```{r, echo = TRUE, message = FALSE, fig.cap = "Asocacion entre PIB y Felicidad. En esta figura observamos que hay una relación positiva pero débil, entre el PIB y el puntaje de felicidad, a mayor PIB; mayor puntaje de felicidad." }
lm( escalera_vida ~ log_pib, data = fel_pais )

ggplot(fel_pais) + geom_point(aes(x = log_pib, y = escalera_vida)) + 
  labs(title ="Asocacion entre PIB y Felicidad", x = "Grado de Felicidad", y = "PIB") +
  geom_abline (intercept = -1.6678, slope = 0.8223, col = 'blue',lwd = 1)

```



### *¿Existe alguna relación entre Felicidad-Esperanza de vida al nacer?*

```{r, echo = FALSE, fig.cap= "Gráfico de esperanza de vida al nacer vs grado de felicidad para paises de Sudamérica. No se observa en todos los paises una relación positiva entre esperanza de vida al nacer y grado de felicidad"}
fel_pais%>%
  ggplot(aes(x = expectativa_vida, y = escalera_vida, colour = pais)) +
geom_point()+ geom_smooth(method=lm)+
  labs(x = "Esperanza de vida al nacer",
y = "Grado de Felicidad",
colour = "Pais") +
theme(aspect.ratio = 1)
```


# Descripción de la aplicación Shiny 









# Comentarios finales


